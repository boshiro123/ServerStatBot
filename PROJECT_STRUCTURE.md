# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ Server Monitor Bot

## –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
ServerStat/
‚îú‚îÄ‚îÄ üìÑ README.md                    # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ INSTALL.md                   # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
‚îú‚îÄ‚îÄ üìÑ PROJECT_STRUCTURE.md         # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ üìÑ requirements.txt             # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ üìÑ Dockerfile                   # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ üìÑ docker-compose.yml           # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ .dockerignore                # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Docker
‚îú‚îÄ‚îÄ üìÑ .gitignore                   # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Git
‚îú‚îÄ‚îÄ üìÑ env.example                  # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ üìÑ Makefile                     # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ üîß start.sh                     # –°–∫—Ä–∏–ø—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
‚îÇ
‚îú‚îÄ‚îÄ üìÇ app/                         # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ bot/                     # Telegram –±–æ—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÇ handlers/            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –±–æ—Ç–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands.py         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ (/start, /status, –∏ —Ç.–¥.)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ callbacks.py        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback-–∫–Ω–æ–ø–æ–∫
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÇ keyboards/           # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ inline.py           # Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ core/                    # –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ monitor.py              # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —Å–∏—Å—Ç–µ–º—ã (psutil)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.py                   # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ charts.py               # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (matplotlib)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scheduler.py            # –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (APScheduler)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ models/                  # –ú–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ metrics.py              # SQLAlchemy –º–æ–¥–µ–ª–∏ (Metric, UserSettings)
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ utils/                   # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ helpers.py              # –£—Ç–∏–ª–∏—Ç—ã –∏ helper —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ
‚îî‚îÄ‚îÄ üìÇ logs/                        # –õ–æ–≥–∏ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
    ‚îî‚îÄ‚îÄ bot.log
```

---

## –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π

### ü§ñ Bot Module (`app/bot/`)

#### `main.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
  - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è handlers
  - –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
  - Polling –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

#### `handlers/commands.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
- **–ö–æ–º–∞–Ω–¥—ã**:
  - `/start` ‚Äî –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `/help` ‚Äî –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
  - `/status` ‚Äî –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
  - `/graph` ‚Äî –í—ã–∑–æ–≤ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
  - `/history` ‚Äî –í—ã–∑–æ–≤ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
  - `/top` ‚Äî –¢–æ–ø –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ CPU –∏ RAM
  - `/setinterval <–º–∏–Ω—É—Ç—ã>` ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–∏
  - `/stop` ‚Äî –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–∏
  - `/settings` ‚Äî –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### `handlers/callbacks.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ inline-–∫–Ω–æ–ø–∫–∏
- **Callbacks**:
  - `graph_<hours>` ‚Äî –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤
  - `history_<hours>` ‚Äî –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥

#### `keyboards/inline.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- **–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã**:
  - `get_period_keyboard()` ‚Äî –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (1—á, 6—á, 24—á, 7–¥)
  - `get_history_keyboard()` ‚Äî –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏

---

### ‚öôÔ∏è Core Module (`app/core/`)

#### `monitor.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–±–æ—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
- **–ö–ª–∞—Å—Å**: `SystemMonitor`
- **–ú–µ—Ç–æ–¥—ã**:
  - `get_cpu_metrics()` ‚Äî CPU usage, load average, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
  - `get_memory_metrics()` ‚Äî RAM usage
  - `get_disk_metrics()` ‚Äî Disk usage
  - `get_network_metrics()` ‚Äî Network traffic
  - `get_process_metrics()` ‚Äî –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
  - `get_uptime()` ‚Äî –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
  - `get_top_processes()` ‚Äî –¢–æ–ø –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
  - `collect_all_metrics()` ‚Äî –°–±–æ—Ä –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ —Ä–∞–∑–æ–º
  - `save_metrics()` ‚Äî –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
  - `get_metrics_for_period()` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –ë–î –∑–∞ –ø–µ—Ä–∏–æ–¥
  - `format_bytes()` ‚Äî –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–π—Ç–æ–≤
  - `format_uptime()` ‚Äî –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ uptime

#### `db.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
  - `engine` ‚Äî –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π SQLAlchemy engine
  - `async_session_maker` ‚Äî –§–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π
  - `init_db()` ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
  - `get_session()` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ (async generator)

#### `charts.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- **–ö–ª–∞—Å—Å**: `ChartGenerator`
- **–ú–µ—Ç–æ–¥—ã**:
  - `create_cpu_chart()` ‚Äî –ì—Ä–∞—Ñ–∏–∫ CPU (usage + load avg)
  - `create_memory_chart()` ‚Äî –ì—Ä–∞—Ñ–∏–∫ RAM
  - `create_disk_chart()` ‚Äî –ì—Ä–∞—Ñ–∏–∫ Disk
  - `create_network_chart()` ‚Äî –ì—Ä–∞—Ñ–∏–∫ Network traffic
  - `create_all_charts()` ‚Äî –í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞–∑–æ–º
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç matplotlib
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç bytes (PNG)
  - –°—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø–æ—Ä–æ–≥–∞–º–∏

#### `scheduler.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
  - `collect_metrics_job()` ‚Äî –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
  - `check_alerts()` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
  - `send_auto_reports_job()` ‚Äî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–æ–≤
  - `send_report_to_user()` ‚Äî –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  - `init_scheduler()` ‚Äî –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è APScheduler
  - `start_scheduler()` / `stop_scheduler()` ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **–ó–∞–¥–∞—á–∏**:
  - –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫: –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥ (MONITOR_INTERVAL)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–æ—Ç—á—ë—Ç–æ–≤: –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
  - –ê–ª–µ—Ä—Ç—ã: –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–æ–≤ (–Ω–µ —á–∞—â–µ —Ä–∞–∑–∞ –≤ 5 –º–∏–Ω—É—Ç)

---

### üóÑÔ∏è Models Module (`app/models/`)

#### `metrics.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: SQLAlchemy –º–æ–¥–µ–ª–∏

##### –ú–æ–¥–µ–ª—å `Metric`

–•—Ä–∞–Ω–∏—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã:

- `id` ‚Äî PK
- `timestamp` ‚Äî –í—Ä–µ–º—è —Å–±–æ—Ä–∞
- `cpu_load_1m, cpu_load_5m, cpu_load_15m` ‚Äî Load average
- `cpu_percent` ‚Äî CPU usage –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
- `cpu_temp` ‚Äî –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ CPU (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `ram_used, ram_total, ram_percent` ‚Äî RAM –º–µ—Ç—Ä–∏–∫–∏
- `disk_used, disk_total, disk_percent` ‚Äî Disk –º–µ—Ç—Ä–∏–∫–∏
- `net_sent, net_recv` ‚Äî Network cumulative bytes
- `process_count` ‚Äî –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

##### –ú–æ–¥–µ–ª—å `UserSettings`

–•—Ä–∞–Ω–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

- `user_id` ‚Äî Telegram user_id (PK)
- `username` ‚Äî Telegram username
- `auto_report_enabled` ‚Äî –í–∫–ª—é—á–µ–Ω–∞ –ª–∏ –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–∞
- `report_interval` ‚Äî –ò–Ω—Ç–µ—Ä–≤–∞–ª –≤ –º–∏–Ω—É—Ç–∞—Ö
- `last_report_time` ‚Äî –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- `alerts_enabled` ‚Äî –í–∫–ª—é—á–µ–Ω—ã –ª–∏ –∞–ª–µ—Ä—Ç—ã
- `created_at, updated_at` ‚Äî –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è

---

### üîß Utils Module (`app/utils/`)

#### `helpers.py`

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–§—É–Ω–∫—Ü–∏–∏**:
  - `get_or_create_user_settings()` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ/—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `get_env_int()` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫–∞–∫ int
  - `get_env_float()` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫–∞–∫ float

---

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### 1. –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫

```
APScheduler ‚Üí collect_metrics_job()
    ‚Üì
SystemMonitor.collect_all_metrics()
    ‚Üì (psutil)
CPU, RAM, Disk, Net
    ‚Üì
SystemMonitor.save_metrics()
    ‚Üì
PostgreSQL (—Ç–∞–±–ª–∏—Ü–∞ metrics)
```

### 2. –ö–æ–º–∞–Ω–¥–∞ /status

```
User ‚Üí /status
    ‚Üì
commands.cmd_status()
    ‚Üì
SystemMonitor.get_cpu_metrics()
SystemMonitor.get_memory_metrics()
SystemMonitor.get_disk_metrics()
    ‚Üì
–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
    ‚Üì
–û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

### 3. –ö–æ–º–∞–Ω–¥–∞ /graph

```
User ‚Üí /graph
    ‚Üì
commands.cmd_graph()
    ‚Üì
–û—Ç–ø—Ä–∞–≤–∫–∞ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    ‚Üì
User –Ω–∞–∂–∏–º–∞–µ—Ç "6 —á–∞—Å–æ–≤"
    ‚Üì
callbacks.callback_graph()
    ‚Üì
SystemMonitor.get_metrics_for_period(6)
    ‚Üì
ChartGenerator.create_all_charts()
    ‚Üì
4 –≥—Ä–∞—Ñ–∏–∫–∞ (CPU, RAM, Disk, Net)
    ‚Üì
–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞–∫ —Ñ–æ—Ç–æ
```

### 4. –ê–≤—Ç–æ–æ—Ç—á—ë—Ç—ã

```
APScheduler (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
    ‚Üì
send_auto_reports_job()
    ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    ‚Üì
–ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ >= report_interval
    ‚Üì
send_report_to_user()
    ‚Üì
–°—Ç–∞—Ç—É—Å + –≥—Ä–∞—Ñ–∏–∫
    ‚Üì
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ last_report_time
```

### 5. –ê–ª–µ—Ä—Ç—ã

```
collect_metrics_job()
    ‚Üì
save_metrics()
    ‚Üì
check_alerts(metric)
    ‚Üì
–ï—Å–ª–∏ CPU/RAM/Disk > –ø–æ—Ä–æ–≥
    ‚Üì
–û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–∞ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
    ‚Üì
–ó–∞–ø–∏—Å—å –≤—Ä–µ–º–µ–Ω–∏ –∞–ª–µ—Ä—Ç–∞ (cooldown 5 –º–∏–Ω)
```

---

## üê≥ Docker —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –û–±—Ä–∞–∑—ã

- `serverstat_app` ‚Äî Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–±–æ—Ç)
- `postgres:15-alpine` ‚Äî –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `adminer:latest` ‚Äî Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ë–î

### Volumes

- `postgres_data` ‚Äî Persistent storage –¥–ª—è PostgreSQL
- `./logs:/app/logs` ‚Äî Bind mount –¥–ª—è –ª–æ–≥–æ–≤

### Networks

- `serverstat_network` ‚Äî Bridge network –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ app

- `pid: "host"` ‚Äî –î–æ—Å—Ç—É–ø –∫ –ø—Ä–æ—Ü–µ—Å—Å–∞–º —Ö–æ—Å—Ç–∞
- `/proc:/host/proc:ro` ‚Äî –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ /proc
- `/sys:/host/sys:ro` ‚Äî –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ /sys

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ

- `TELEGRAM_TOKEN` ‚Äî –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç BotFather

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- `DATABASE_URL` ‚Äî –ü–æ–ª–Ω—ã–π URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `DB_HOST`, `DB_PORT`, `DB_NAME`, `DB_USER`, `DB_PASSWORD` ‚Äî –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

- `MONITOR_INTERVAL` ‚Äî –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ (—Å–µ–∫—É–Ω–¥—ã, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60)
- `ALERT_CPU_THRESHOLD` ‚Äî –ü–æ—Ä–æ–≥ CPU –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤ (%, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 90)
- `ALERT_RAM_THRESHOLD` ‚Äî –ü–æ—Ä–æ–≥ RAM –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤ (%, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 90)
- `ALERT_DISK_THRESHOLD` ‚Äî –ü–æ—Ä–æ–≥ Disk –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤ (%, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 90)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- `LOG_LEVEL` ‚Äî –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARNING, ERROR)

---

## üìä –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- **aiogram 3.3.0** ‚Äî Telegram Bot API framework
- **psutil 5.9.6** ‚Äî –°–±–æ—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
- **matplotlib 3.8.2** ‚Äî –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- **SQLAlchemy 2.0.23** ‚Äî ORM –¥–ª—è –ë–î
- **asyncpg 0.29.0** ‚Äî PostgreSQL driver
- **APScheduler 3.10.4** ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ

- **python-dotenv 1.0.0** ‚Äî –ó–∞–≥—Ä—É–∑–∫–∞ .env
- **aiohttp 3.9.1** ‚Äî HTTP –∫–ª–∏–µ–Ω—Ç (–¥–ª—è aiogram)
- **pillow 10.1.0** ‚Äî –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

---

## üéØ –¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–µ—Ç—Ä–∏–∫–∏

1. –û–±–Ω–æ–≤–∏—Ç–µ –º–æ–¥–µ–ª—å `Metric` –≤ `app/models/metrics.py`
2. –î–æ–±–∞–≤—å—Ç–µ –º–µ—Ç–æ–¥ —Å–±–æ—Ä–∞ –≤ `SystemMonitor` (`app/core/monitor.py`)
3. –û–±–Ω–æ–≤–∏—Ç–µ `collect_all_metrics()` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–µ—Ç—Ä–∏–∫–∏
4. –î–æ–±–∞–≤—å—Ç–µ –≥—Ä–∞—Ñ–∏–∫ –≤ `ChartGenerator` (`app/core/charts.py`) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã

1. –î–æ–±–∞–≤—å—Ç–µ handler –≤ `app/bot/handlers/commands.py`
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@router.message(Command("your_command"))`
3. –û–±–Ω–æ–≤–∏—Ç–µ `/help` —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏

1. –°–æ–∑–¥–∞–π—Ç–µ async —Ñ—É–Ω–∫—Ü–∏—é –≤ `app/core/scheduler.py`
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –µ—ë –≤ `init_scheduler()` —Å –Ω—É–∂–Ω—ã–º —Ç—Ä–∏–≥–≥–µ—Ä–æ–º
3. –õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤

- `bot.log` ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- Docker logs ‚Äî `docker-compose logs -f app`

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- **DEBUG** ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–º–µ—Ç—Ä–∏–∫–∏, –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ)
- **INFO** ‚Äî –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–∑–∞–ø—É—Å–∫, –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–æ–≤)
- **WARNING** ‚Äî –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏)
- **ERROR** ‚Äî –û—à–∏–±–∫–∏ (–∏—Å–∫–ª—é—á–µ–Ω–∏—è, —Å–±–æ–∏)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥

1. `/start` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. `/status` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫
3. `/graph` ‚Üí 1 —á–∞—Å ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤
4. `/history` ‚Üí 24 —á–∞—Å–∞ ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
5. `/top` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
6. `/setinterval 1` ‚Üí –ü–æ–¥–æ–∂–¥–∞—Ç—å 1 –º–∏–Ω—É—Ç—É ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–æ—Ç—á—ë—Ç–∞
7. `/stop` ‚Äî –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–æ—Ç—á—ë—Ç–æ–≤
8. `/settings` ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤

1. –°–∏–º—É–ª–∏—Ä—É–π—Ç–µ –≤—ã—Å–æ–∫—É—é –Ω–∞–≥—Ä—É–∑–∫—É (stress, yes > /dev/null)
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ø–æ—Ä–æ–≥–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞ –≤ –±–æ—Ç–µ

---

## üîß Troubleshooting

–°–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **Troubleshooting** –≤ [README.md](README.md) –∏ [INSTALL.md](INSTALL.md)

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: 2025-10-05
